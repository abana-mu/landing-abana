<template>
  <Layout class="index-layout">
    <div id="parallax-over" class="relative z-1 bg-white">
      <div id="banner" class="relative w-full flex flex-col md:flex-row justify-center bg-white">
        <div class="contain lg:h-full w-full flex flex-col justify-between z-10 ">
          <div class="w-full pt-24 pb-20 h-full text-center md:text-left flex flex-col justify-center items-center md:items-start">
            <div class="marketing text-4xl lg:text-5xl lg:leading-normal font-light mb-6 max-w-5xl mx-auto text-title text-center mb-20" data-aos="fade-up" data-aos-duration="800">
              Connect with <b>apparel manufacturers, fabric suppliers and service provicers</b> from Africa, Madagascar and Mauritius.
            </div>

            <div class="contain text-center" data-aos="fade-up" data-aos-duration="800" data-aos-delay="200">
              <g-link to="/registration/" class="btn-xl btn-primary">Register as a free buyer</g-link>
            </div>
          </div>
        </div>
      </div>

      <div class="relative overflow-hidden text-center text-gray-50 m-0">
        <svg class="w-full" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1366 64" preserveAspectRatio="none">
          <path fill="currentColor" d="M1366,64H0V.0337c205,0,709,55.6648,1366,55.6648Z"></path>
        </svg>
      </div>

      <div class="bg-gray-50">
        <div class="contain py-24">
          <div>
            <div class="text-primary tracking-wide font-medium text-lg mb-4">Who are we</div>
            <div class="text-2xl font-medium mb-10 max-w-4xl">
              The first textile & apparel sourcing platform that connects worldwide buyers, manufacturers and suppliers of Africa, Madagascar and Mauritius.
            </div>
          </div>
          <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-10">
            <div class="p-10 bg-white shadow-xl rounded-xl">
              <g-image class="mx-auto mb-4 h-16 w-16" src="~/assets/images/database.svg" />
              <div class="text-lg">Search our database to find detailed & relevant seller profiles</div>
            </div>
            <div class="p-10 bg-white shadow-xl rounded-xl">
              <g-image class="mx-auto mb-4 h-16 w-16" src="~/assets/images/direct.svg" />
              <div class="text-lg">Deal directly with your suppliers, no commission fee is charged by ABANA</div>
            </div>
            <div class="p-10 bg-white shadow-xl rounded-xl">
              <g-image class="mx-auto mb-4 h-16 w-16" src="~/assets/images/opportunities.svg" />
              <div class="text-lg">Find product and sourcing opportunities on our marketplace</div>
            </div>
            <div class="p-10 bg-white shadow-xl rounded-xl">
              <g-image class="mx-auto mb-4 h-16 w-16" src="~/assets/images/grow.svg" />
              <div class="text-lg">Use our experience, network, and on-the-ground offline support to grow in the region</div>
            </div>
          </div>
          <div class="contain text-center">
            <g-link to="/registration/" class="btn-lg btn-primary">Register as a free buyer</g-link>
          </div>
        </div>
      </div>

      <div class="relative overflow-hidden text-center text-gray-50 m-0">
        <svg class="w-full transform rotate-180" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1366 64" preserveAspectRatio="none">
          <path fill="currentColor" d="M1366,64H0V.0337c205,0,709,55.6648,1366,55.6648Z"></path>
        </svg>
      </div>

      <div class="contain-tight py-28">
        <div class="text-4xl lg:text-5xl mb-4 font-bold text-title text-center mb-24">Our value-added services:</div>

        <div class="space-y-20">
          <div class="grid md:grid-cols-2 items-center gap-10">
            <div class="flex flex-col">
              <div class="text-2xl font-medium text-primary mb-4">Personalised advice</div>
              <div class="text-lg">
                We can help you on woven, knit, denim and jersey apparel production from basic to premium. Tell us what you are looking for and we connect you with vetted suppliers based on your
                specific business needs (product, price, MOQ, lead times).
              </div>
            </div>
            <div class="">
              <g-image src="/uploads/country-rep.jpg" quality="100" width="750" class="rounded-md w-full shadow-xl" />
            </div>
          </div>

          <div class="grid md:grid-cols-2 items-center gap-10">
            <div class="flex flex-col">
              <div class="text-2xl font-medium text-primary mb-4">Agency</div>
              <div class="text-lg">
                Save time and build your supply chain in Africa with our on-the-ground support. Pick and choose from our range of services tailored to your business needs.
              </div>
            </div>
            <div class="">
              <g-image src="/uploads/jeans-2.jpg" quality="100" width="750" class="rounded-md w-full shadow-xl" />
            </div>
          </div>

          <div class="grid md:grid-cols-2 items-center gap-10">
            <div class="flex flex-col">
              <div class="text-2xl font-medium text-primary mb-4">Virtual Factory</div>
              <div class="text-lg">
                Use us as your one-stop shop supplier solution to access our trusted specialised factories producing woven, denim, jersey and knitwear.
              </div>
            </div>
            <div class="">
              <g-image src="/uploads/knit2.jpg" quality="100" width="750" class="rounded-md w-full shadow-xl" />
            </div>
          </div>
        </div>
      </div>

      <div class="bg-gray-50 border-t border-b">
        <div class="contain-tight py-28">
          <div class="text-4xl lg:text-5xl mb-4 font-bold text-title text-center mb-8">A trusted partner at your side</div>
          <div class="text-2xl text-center">
            More than <span class="text-primary font-medium">65 years</span> of combined textile sector experience as Makers & Buyers, working with industry-leading factories.
            <span class="text-primary font-medium">ABANA is a one-stop shop</span>
            inclusively connecting all modern industry players throughout the full supply chain.
          </div>
        </div>
      </div>
    </div>
    <div id="spacer" class="hidden md:flex"></div>
    <div id="parallax-under" class="overflow-hidden bg-primary md:h-full top-0 z-0 w-full">
      <div class="contain pt-28">
        <h2 class="text-2xl lg:text-5xl font-medium mb-16 text-center text-primary-100">What industry leading voices are saying:</h2>

        <div class="py-4 mb-12">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-10 max-w-4xl mx-auto">
            <div class="flex flex-col justify-around bg-white rounded-lg shadow-xl border px-8 py-16" v-for="testi in $page.posts.edges" :key="testi.id">
              <div class="w-full max-w-xs px-16 mb-8">
                <g-image :src="testi.node.logo" class="w-full" />
              </div>
              <p class="text-body text-xl pb-16">"{{ testi.node.blurb }}"</p>
              <div class="flex flex-row items-center space-x-4">
                <div class="h-24 w-24 rounded-full overflow-hidden flex-shrink-0">
                  <g-image :src="testi.node.image" class="w-full h-full object-cover object-top" />
                </div>
                <div class="flex flex-col text-title">
                  <h4 class="font-bold">{{ testi.node.name }}</h4>
                  <div class="flex flex-col justify-content-center">
                    <p class="text-base">{{ testi.node.title }}</p>
                    <p class="text-sm">{{ testi.node.position }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full flex justify-center pb-10">
          <g-link to="/testimonials/" class="btn btn-light">See full testimonials</g-link>
        </div>
      </div>
    </div>
    <div class="bg-gray-50 border-t border-b">
      <div class="contain my-12">
        <IndexTrusted :data="Data.trusted" class="w-full max-w-screen-lg mx-auto" />
      </div>
    </div>
    <div class="contain text-center my-20">
      <g-link to="/registration/" class="btn-2xl btn-primary">Register as a free buyer</g-link>
    </div>
  </Layout>
</template>

<!-- QUERIES -->
<page-query>
query{
  posts: allTestimonials(filter: { featured: { eq: true }}){
    edges{
      node{
        id
        title
        featured
        blurb
        name
        position
        image
        logo
      }
    }
  }
}
</page-query>

<script>
import IndexBanner from '~/components/IndexBanner';
import Data from '~/_settings/landing.json';
import Flow from '~/components/icons/Flow';
import ITransf from '@/components/icons/ITransf';
import IExpect from '@/components/icons/IExpect';
import IGuar from '@/components/icons/IGuar';
import ITax from '@/components/icons/ITax';
import ITarget from '@/components/icons/ITarget';
import Lottie from 'vue-lottie';
import supportAnimation from '@/assets/animation/support.json';
import networkAnimation from '@/assets/animation/network.json';

import INew from '@/components/icons/INew';
import IChina from '@/components/icons/IChina';
import IEnv from '@/components/icons/IEnv';
import ICheck from '@/components/icons/ICheck';
import ICal from '@/components/icons/ICal';
import IndexFlowGraph from '~/components/IndexFlowGraph';
import IndexDropGraph from '~/components/IndexDropGraph';
import IndexRepsGraph from '~/components/IndexRepsGraph';
import IndexTrusted from '~/components/IndexTrusted';

export default {
  metaInfo: {
    title: 'ABANA | African Textile & Apparel Marketplace',
    meta: [
      {
        name: 'description',
        content: 'Welcome to the first B2B sourcing platform for Textile and Apparel Africa. We help Textile and Apparel buyers find an connect to suppliers.',
      },
    ],
  },
  components: {
    Lottie,
    IndexBanner,
    box1: IChina,
    box2: ICheck,
    box3: IEnv,
    box4: ICal,
    IndexFlowGraph,
    IndexDropGraph,
    IndexRepsGraph,
    IndexTrusted,
    Flow,
  },
  data() {
    return {
      Data,
      networkAnimationData: { animationData: networkAnimation },
      supportAnimationData: { animationData: supportAnimation },
    };
  },
  mounted() {
    window.addEventListener('scroll', this.handleScroll);
    var width = window.innerWidth;
    if (width > 768) {
      var footer = document.querySelector('footer');
      var over = document.getElementById('parallax-over');
      var spacer = document.getElementById('spacer');
      var under = document.getElementById('parallax-under');
      footer.classList.add('fixed');
      under.classList.add('fixed');
      under.classList.add('opacity-0');
      spacer.style.height = under.getBoundingClientRect().height + footer.getBoundingClientRect().height + 'px';
      window.addEventListener('scroll', function() {
        if (window.scrollY > 40) {
          under.classList.remove('opacity-0');
        } else {
          under.classList.add('opacity-0');
        }
        if (over.getBoundingClientRect().bottom > 1) {
          spacer.classList.remove('fixed');
          footer.classList.add('fixed');
          under.classList.add('fixed');
        }
        if (over.getBoundingClientRect().bottom <= 1) {
          spacer.classList.add('fixed');
          footer.classList.remove('fixed');
          under.classList.remove('fixed');
        }
      });
    }
  },
  destroyed() {
    window.removeEventListener('scroll', this.handleScroll);
  },
  methods: {
    isBlockScrolled(el) {
      var block = el.getBoundingClientRect();
      return block.top <= window.innerHeight * 0.5;
    },
    stickyElement() {
      var blocks = document.querySelectorAll('.block-item');
      blocks.forEach((block, index) => {
        let imageBlock = document.getElementById(block.id + '-image');

        if (index % 10 != 0) {
          if (this.isBlockScrolled(block)) {
            imageBlock.classList.remove('opacity-0');
          } else {
            imageBlock.classList.add('opacity-0');
          }
        }
      });
    },
    handleScroll() {
      this.stickyElement();
    },
  },
};
</script>

<style lang="scss" scoped>
footer,
#parallax-under {
  @media (max-width: $break-md) {
    position: static !important;
  }
}

#banner-image {
  width: 125%;
}

#image-container {
  height: calc(100vh - 11.875rem);
  top: 90px;
  padding: 3.75rem 0;
}

.home-links a {
  margin-right: 1rem;
}

#boxTitle {
  text-align: center;
  margin-bottom: 1rem;
}

#boxSub {
  margin: auto auto;
  color: $subtitle-dark;
  margin-bottom: 2rem;
  font-weight: 500;
  text-align: center;
}

.box-row {
  display: flex;
  flex-direction: column;
  @media (min-width: $break-md) {
    flex-direction: row;
  }
}
</style>
